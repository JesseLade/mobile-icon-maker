workflows:
  raylib_ios_build:
    name: Raylib iOS Build Demi ðŸ’–
    environment:
      xcode: latest
      cocoapods: default
    scripts:
      - name: Install CMake and Ninja
        script: |
          brew install cmake ninja
      - name: Get iOS CMake Toolchain
        script: |
          git clone https://github.com/leetal/ios-cmake.git ~/ios-cmake
      - name: Clone Raylib (if needed)
        script: |
          git submodule update --init --recursive
      - name: Build Raylib iOS App
        script: |
          mkdir -p build
          cd build
          cmake .. \
            -G Ninja \
            -DCMAKE_TOOLCHAIN_FILE=$HOME/ios-cmake/ios.toolchain.cmake \
            -DIOS_PLATFORM=OS \
            -DCMAKE_BUILD_TYPE=Release
          cmake --build . --config Release
      - name: Package .ipa
        script: |
          mkdir -p Payload/icon_maker.app
          cp -R build/icon_maker.app/* Payload/icon_maker.app/
          zip -r raylib_icon_maker.ipa Payload
    artifacts:
      - raylib_icon_maker.ipa
